# {{ ansible_managed }}
# /etc/systemd/system/redis_exporter.service
[Unit]
Description=Redis Exporter
Wants=network-online.target
After=network-online.target

[Service]
User=redis
Group=redis
Type=simple
{% if redis_role is defined and redis_role == "master" %}
{% set redis_use_port = redis_cluster_conf.master_port | default('6379') %}
{% else %}
{% set redis_use_port = redis_cluster_conf.slave_port | default('6379') %}
{% endif %}
{% if redis_cluster_conf.requirepass is defined %}
{% set redis_password_val = ' -redis.password ' ~ redis_cluster_conf.requirepass %}
{% else %}
{% set redis_password_val = '' %}
{% endif %}
ExecStart=/usr/local/bin/redis_exporter -redis.addr redis://127.0.0.1:{{ redis_use_port }}{{ redis_password_val }}
[Install]
WantedBy=multi-user.target
